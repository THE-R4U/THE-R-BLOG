기계 학습을위한 선형 대수와 R의 딥러닝
================

이 기사에서는 R에서 기계 학습 및 심층 학습을위한 선형 대수학을 수행하는 방법에 대해 알아 봅니다. 특히, 행렬 곱셈, 선형
방정식 풀기, 항등 행렬, 행렬 역변환, 선형 방정식 시스템 재실행, 찾기 Matrix Norm, Frobenius
Norm, 특수 행렬과 벡터, Eigendecomposition, 특이 값 분해, Moore-Penrose
Pseudoinverse 및 Matrix Trace를 포함합니다.

## 소개

선형 대수학은 데이터 과학 전반에 널리 사용되는 수학의 한 분야입니다. 그러나 선형 대수학은 이산적인 수학보다는 연속적인 형태이기
때문에 많은 데이터 과학자들은이 수학을 거의 경험하지 못했습니다. 선형 대수학에 대한 올바른 이해는 기계 학습 및 심층 학습
알고리즘을 이해하고 작업하는 데 필수적입니다. 이 기사는 특히이 두 계량 경제학 / 통계학 분야의 선형 대수학을
목표로합니다. R을 사용하여 기계 학습 및 심층 학습을위한 선형 대수학 세계로 뛰어 들어 보겠습니다.

## 행렬 곱셈

R에서 행렬 곱셈을 만드는 것으로 시작합시다.

``` r
A <- matrix(data = 1:36, nrow = 6)
A
```

    ##      [,1] [,2] [,3] [,4] [,5] [,6]
    ## [1,]    1    7   13   19   25   31
    ## [2,]    2    8   14   20   26   32
    ## [3,]    3    9   15   21   27   33
    ## [4,]    4   10   16   22   28   34
    ## [5,]    5   11   17   23   29   35
    ## [6,]    6   12   18   24   30   36

``` r
B <- matrix(data = 1:30, nrow = 6)
B
```

    ##      [,1] [,2] [,3] [,4] [,5]
    ## [1,]    1    7   13   19   25
    ## [2,]    2    8   14   20   26
    ## [3,]    3    9   15   21   27
    ## [4,]    4   10   16   22   28
    ## [5,]    5   11   17   23   29
    ## [6,]    6   12   18   24   30

``` r
A %*% B
```

    ##      [,1] [,2] [,3] [,4] [,5]
    ## [1,]  441 1017 1593 2169 2745
    ## [2,]  462 1074 1686 2298 2910
    ## [3,]  483 1131 1779 2427 3075
    ## [4,]  504 1188 1872 2556 3240
    ## [5,]  525 1245 1965 2685 3405
    ## [6,]  546 1302 2058 2814 3570

\#\#\#하다 마드 곱셈 R에서하다 마드 곱셈을 시도해 봅시다.

``` r
A <- matrix(data = 1:36, nrow = 6)
A
```

    ##      [,1] [,2] [,3] [,4] [,5] [,6]
    ## [1,]    1    7   13   19   25   31
    ## [2,]    2    8   14   20   26   32
    ## [3,]    3    9   15   21   27   33
    ## [4,]    4   10   16   22   28   34
    ## [5,]    5   11   17   23   29   35
    ## [6,]    6   12   18   24   30   36

``` r
B <- matrix(data = 11:46, nrow = 6)
```

``` r
A * B
```

    ##      [,1] [,2] [,3] [,4] [,5] [,6]
    ## [1,]   11  119  299  551  875 1271
    ## [2,]   24  144  336  600  936 1344
    ## [3,]   39  171  375  651  999 1419
    ## [4,]   56  200  416  704 1064 1496
    ## [5,]   75  231  459  759 1131 1575
    ## [6,]   96  264  504  816 1200 1656

### 도트 제품

이제 점 제품을 R로 만들자

``` r
X <- matrix(data = 1:10, nrow = 10)
X
```

    ##       [,1]
    ##  [1,]    1
    ##  [2,]    2
    ##  [3,]    3
    ##  [4,]    4
    ##  [5,]    5
    ##  [6,]    6
    ##  [7,]    7
    ##  [8,]    8
    ##  [9,]    9
    ## [10,]   10

``` r
Y <- matrix(data = 11:20, nrow = 10)
Y
```

    ##       [,1]
    ##  [1,]   11
    ##  [2,]   12
    ##  [3,]   13
    ##  [4,]   14
    ##  [5,]   15
    ##  [6,]   16
    ##  [7,]   17
    ##  [8,]   18
    ##  [9,]   19
    ## [10,]   20

이제 R에서 Dot Product 함수를 만듭니다.

``` r
dotProduct <- function(X, Y) {
    as.vector(t(X) %*% Y)
}
dotProduct(X, Y)
```

    ## [1] 935

### 행렬 곱셈의 속성

R에서 행렬의 곱의 속성을 봅시다.

1.  매트릭스 속성 : 분배 매트릭스

<!-- end list -->

``` r
A <- matrix(data = 1:25, nrow = 5)
B <- matrix(data = 26:50, nrow = 5)
C <- matrix(data = 51:75, nrow = 5)
```

``` r
A %*% (B + C)
```

    ##      [,1] [,2] [,3] [,4] [,5]
    ## [1,] 4555 5105 5655 6205 6755
    ## [2,] 4960 5560 6160 6760 7360
    ## [3,] 5365 6015 6665 7315 7965
    ## [4,] 5770 6470 7170 7870 8570
    ## [5,] 6175 6925 7675 8425 9175

``` r
A %*% B + A %*% C
```

    ##      [,1] [,2] [,3] [,4] [,5]
    ## [1,] 4555 5105 5655 6205 6755
    ## [2,] 4960 5560 6160 6760 7360
    ## [3,] 5365 6015 6665 7315 7965
    ## [4,] 5770 6470 7170 7870 8570
    ## [5,] 6175 6925 7675 8425 9175

2.행렬 속성 : 연관 행렬입니다.

``` r
A <- matrix(data = 1:25, nrow = 5)
B <- matrix(data = 26:50, nrow = 5)
C <- matrix(data = 51:75, nrow = 5)
```

``` r
A %*% (B + C)
```

    ##      [,1] [,2] [,3] [,4] [,5]
    ## [1,] 4555 5105 5655 6205 6755
    ## [2,] 4960 5560 6160 6760 7360
    ## [3,] 5365 6015 6665 7315 7965
    ## [4,] 5770 6470 7170 7870 8570
    ## [5,] 6175 6925 7675 8425 9175

``` r
A %*% B + A %*% C
```

    ##      [,1] [,2] [,3] [,4] [,5]
    ## [1,] 4555 5105 5655 6205 6755
    ## [2,] 4960 5560 6160 6760 7360
    ## [3,] 5365 6015 6665 7315 7965
    ## [4,] 5770 6470 7170 7870 8570
    ## [5,] 6175 6925 7675 8425 9175

3.  Matrix Property : 그것은 Commutative Matrix가 아닙니다.

<!-- end list -->

``` r
A <- matrix(data = 1:25, nrow = 5)
B <- matrix(data = 26:50, nrow = 5)
```

``` r
A %*% B
```

    ##      [,1] [,2] [,3] [,4] [,5]
    ## [1,] 1590 1865 2140 2415 2690
    ## [2,] 1730 2030 2330 2630 2930
    ## [3,] 1870 2195 2520 2845 3170
    ## [4,] 2010 2360 2710 3060 3410
    ## [5,] 2150 2525 2900 3275 3650

``` r
B %*% A
```

    ##      [,1] [,2] [,3] [,4] [,5]
    ## [1,]  590 1490 2390 3290 4190
    ## [2,]  605 1530 2455 3380 4305
    ## [3,]  620 1570 2520 3470 4420
    ## [4,]  635 1610 2585 3560 4535
    ## [5,]  650 1650 2650 3650 4650

\#\#행렬 변환 R에서 Matrix Transpose를 살펴 보겠습니다.

``` r
A <- matrix(data = 1:25, nrow = 5, ncol = 5, byrow = TRUE)
A
```

    ##      [,1] [,2] [,3] [,4] [,5]
    ## [1,]    1    2    3    4    5
    ## [2,]    6    7    8    9   10
    ## [3,]   11   12   13   14   15
    ## [4,]   16   17   18   19   20
    ## [5,]   21   22   23   24   25

``` r
t(A)
```

    ##      [,1] [,2] [,3] [,4] [,5]
    ## [1,]    1    6   11   16   21
    ## [2,]    2    7   12   17   22
    ## [3,]    3    8   13   18   23
    ## [4,]    4    9   14   19   24
    ## [5,]    5   10   15   20   25

R에서 Matrix Transpose Property를 살펴 보겠습니다.

``` r
A <- matrix(data = 1:25, nrow = 5)
B <- matrix(data = 25:49, nrow = 5)
```

``` r
t(A %*% B)
```

    ##      [,1] [,2] [,3] [,4] [,5]
    ## [1,] 1535 1670 1805 1940 2075
    ## [2,] 1810 1970 2130 2290 2450
    ## [3,] 2085 2270 2455 2640 2825
    ## [4,] 2360 2570 2780 2990 3200
    ## [5,] 2635 2870 3105 3340 3575

``` r
t(B) %*% t(A)
```

    ##      [,1] [,2] [,3] [,4] [,5]
    ## [1,] 1535 1670 1805 1940 2075
    ## [2,] 1810 1970 2130 2290 2450
    ## [3,] 2085 2270 2455 2640 2825
    ## [4,] 2360 2570 2780 2990 3200
    ## [5,] 2635 2870 3105 3340 3575

\#\#선형 방정식 시스템 풀기 이제 R에서 선형 방정식 시스템을 풀어
보겠습니다.

``` r
Ax = B
```

``` r
A <- matrix(data = c(1, 3, 2, 4, 2, 4, 3, 5, 1, 6, 7, 2, 1, 5, 6, 7), nrow = 4, byrow = TRUE)
A
```

    ##      [,1] [,2] [,3] [,4]
    ## [1,]    1    3    2    4
    ## [2,]    2    4    3    5
    ## [3,]    1    6    7    2
    ## [4,]    1    5    6    7

``` r
B <- matrix(data = c(1, 2, 3, 4), nrow = 4)
B
```

    ##      [,1]
    ## [1,]    1
    ## [2,]    2
    ## [3,]    3
    ## [4,]    4

``` r
solve(a = A, b = B)
```

    ##            [,1]
    ## [1,]  0.6153846
    ## [2,] -0.8461538
    ## [3,]  1.0000000
    ## [4,]  0.2307692

## 단위 행렬

이제 R에서 Identity Matrix를 해결해 보겠습니다.

``` r
I <- diag(x = 1, nrow = 5, ncol = 5)
I
```

    ##      [,1] [,2] [,3] [,4] [,5]
    ## [1,]    1    0    0    0    0
    ## [2,]    0    1    0    0    0
    ## [3,]    0    0    1    0    0
    ## [4,]    0    0    0    1    0
    ## [5,]    0    0    0    0    1

``` r
A <- matrix(data = 1:25, nrow = 5)
```

``` r
A %*% I
```

    ##      [,1] [,2] [,3] [,4] [,5]
    ## [1,]    1    6   11   16   21
    ## [2,]    2    7   12   17   22
    ## [3,]    3    8   13   18   23
    ## [4,]    4    9   14   19   24
    ## [5,]    5   10   15   20   25

``` r
I %*% A
```

    ##      [,1] [,2] [,3] [,4] [,5]
    ## [1,]    1    6   11   16   21
    ## [2,]    2    7   12   17   22
    ## [3,]    3    8   13   18   23
    ## [4,]    4    9   14   19   24
    ## [5,]    5   10   15   20   25

\#\#행렬 역행렬 이제 R에서 행렬 역변환을
해봅시다.

``` r
A <- matrix(data = c(1, 2, 3, 1, 2, 3, 4, 5, 6, 2, 3, 4, 5, 6, 7, 8, 9, 1, 2, 3, 4, 5, 6, 7, 3), nrow = 5)
A
```

    ##      [,1] [,2] [,3] [,4] [,5]
    ## [1,]    1    3    3    8    4
    ## [2,]    2    4    4    9    5
    ## [3,]    3    5    5    1    6
    ## [4,]    1    6    6    2    7
    ## [5,]    2    2    7    3    3

``` r
library(MASS)
ginv(A)
```

    ##            [,1]       [,2]       [,3]       [,4]          [,5]
    ## [1,] -0.3333333  0.3333333  0.3333333 -0.3333333  1.179612e-16
    ## [2,] -4.0888889  3.6444444 -1.2222222  0.8666667 -2.000000e-01
    ## [3,] -0.3555556  0.2444444 -0.2222222  0.1333333  2.000000e-01
    ## [4,] -0.1111111  0.2222222 -0.1111111  0.0000000  2.602085e-18
    ## [5,]  3.8888889 -3.4444444  1.2222222 -0.6666667 -2.664535e-15

``` r
ginv(A) %*% A
```

    ##               [,1]          [,2]          [,3]          [,4]          [,5]
    ## [1,]  1.000000e+00 -1.540434e-15 -9.506285e-16 -5.342948e-16 -1.866562e-15
    ## [2,]  8.881784e-16  1.000000e+00 -5.329071e-15 -1.287859e-14 -2.464695e-14
    ## [3,] -5.551115e-17 -1.165734e-15  1.000000e+00 -8.881784e-16 -1.776357e-15
    ## [4,] -2.168404e-16 -7.719519e-16 -7.589415e-16  1.000000e+00 -1.213439e-15
    ## [5,]  0.000000e+00  1.953993e-14  6.217249e-15  1.265654e-14  1.000000e+00

``` r
A %*% ginv(A)
```

    ##               [,1]         [,2]          [,3]         [,4]          [,5]
    ## [1,]  1.000000e+00 1.776357e-15 -1.776357e-15 2.220446e-15 -1.200429e-15
    ## [2,] -7.105427e-15 1.000000e+00 -1.776357e-15 1.332268e-15 -5.316927e-16
    ## [3,] -3.552714e-15 0.000000e+00  1.000000e+00 1.332268e-15  1.136244e-16
    ## [4,]  0.000000e+00 3.552714e-15  0.000000e+00 1.000000e+00  2.272488e-16
    ## [5,] -5.329071e-15 5.329071e-15 -8.881784e-16 1.776357e-15  1.000000e+00

\#\#재검색 된 선형 방정식 시스템 풀기 R에서 재검색 된 선형 방정식의 해법을 살펴
보자.

``` r
A <- matrix(data = c(1, 3, 2, 4, 2, 4, 3, 5, 1, 6, 7, 2, 1, 5, 6, 7), nrow = 4, byrow = TRUE)
A
```

    ##      [,1] [,2] [,3] [,4]
    ## [1,]    1    3    2    4
    ## [2,]    2    4    3    5
    ## [3,]    1    6    7    2
    ## [4,]    1    5    6    7

``` r
B <- matrix(data = c(1, 2, 3, 4), nrow = 4)
B
```

    ##      [,1]
    ## [1,]    1
    ## [2,]    2
    ## [3,]    3
    ## [4,]    4

``` r
library(MASS)
X <- ginv(A) %*% B
X
```

    ##            [,1]
    ## [1,]  0.6153846
    ## [2,] -0.8461538
    ## [3,]  1.0000000
    ## [4,]  0.2307692

\#\#결정자 R에서 결정자 행렬을
찾자.

``` r
A <- matrix(data = c(1, 3, 2, 4, 2, 4, 3, 5, 1, 6, 7, 2, 1, 5, 6, 7), nrow = 4, byrow = TRUE)
A
```

    ##      [,1] [,2] [,3] [,4]
    ## [1,]    1    3    2    4
    ## [2,]    2    4    3    5
    ## [3,]    1    6    7    2
    ## [4,]    1    5    6    7

``` r
det(A)
```

    ## [1] -39
